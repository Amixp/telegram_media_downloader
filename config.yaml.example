# Конфигурация Telegram Media Downloader

# API ключи Telegram (получить на https://my.telegram.org/apps)
api_id: your_api_id
api_hash: your_api_hash

# Язык интерфейса (ru или en)
language: ru

# Настройки загрузки
download_settings:
  # Количество одновременных загрузок (None = без ограничений)
  max_parallel_downloads: 5
  # Количество сообщений для обработки в одном пакете
  pagination_limit: 100
  # Базовая директория для загрузок (пусто = директория скрипта)
  base_directory: ""
  # Пропускать дубликаты файлов
  skip_duplicates: true
  # Загружать историю сообщений (текстовые сообщения)
  download_message_history: false
  # Формат истории (json или txt)
  history_format: json
  # Директория для истории сообщений
  history_directory: history

# Типы медиа для загрузки
# Можно указать конкретные типы или "all" для всех типов
media_types:
  - all
  # Или конкретные типы:
  # - audio
  # - document
  # - photo
  # - video
  # - voice
  # - video_note

# Форматы файлов для загрузки (для audio, document, video)
file_formats:
  audio:
    - all
  document:
    - all
  video:
    - all

# Фильтр по отправителю
sender_filter:
  enabled: false
  # Список ID пользователей
  user_ids: []
  # Список username (с @ или без)
  usernames: []

# Фильтры по дате
# start_date: "2024-01-01"  # Начальная дата (ISO формат)
# end_date: "2024-12-31"    # Конечная дата (ISO формат)
# max_messages: 1000        # Максимальное количество сообщений для загрузки

# Настройки логирования
logging:
  file_logging:
    enabled: false
    file_path: downloads.log
    level: INFO  # DEBUG, INFO, WARNING, ERROR
    max_bytes: 10485760  # 10 MB
    backup_count: 5

# Настройки прокси (опционально)
# proxy:
#   scheme: socks5  # socks4, socks5, http
#   hostname: 11.22.33.44
#   port: 1234
#   username: your_username  # опционально
#   password: your_password  # опционально

# Интерактивный выбор чатов при запуске
interactive_chat_selection: true

# UI для выбора чатов:
# - classic: текущий режим (ввод команд/номеров)
# - tui: клавиатурный TUI (↑/↓, Space=выбор, Enter=OK) + превью последнего сообщения
chat_selection_ui: tui

# Настройки TUI (опционально). Если секция отсутствует — используются дефолты из кода.
tui:
  display:
    # Показывать ли chat_id рядом с названием чата (в списке) и в превью справа
    show_chat_id: true
  preview:
    # Сколько последних сообщений показывать в превью справа.
    # 1 = без сетевых запросов (берётся dialog.message). >1 = подкачка по курсору (вариант B).
    messages_count: 1
    # Режим получения сообщений, если messages_count > 1:
    # - auto: on_demand если messages_count > 1, иначе off
    # - on_demand: подкачка по курсору + кэш
    # - off: никогда не делать сетевых запросов (даже если messages_count > 1)
    fetch_mode: auto
    # Дебаунс перед запросом после остановки курсора (мс)
    debounce_ms: 200
    # Кэш превью (LRU) по chat_id
    cache_size: 128
    cache_ttl_s: 300
    # Вариант D: перенос строк и ограничение высоты превью
    wrap: true
    max_lines: 12
    show_loading: true
    loading_text: "Загружаю…"
    error_text: "Ошибка загрузки превью"
    label_single: "Последнее сообщение:"
    label_multi: "Последние сообщения:"
    include_media_placeholder: true
    # Частота опроса клавиатуры/обновления (мс). Меньше = отзывчивее, но больше CPU.
    poll_interval_ms: 33
  colors:
    # Цвета: black, red, green, yellow, blue, magenta, cyan, white, default
    # *_bg — фон. "default" = цвета терминала.
    # Общий фон/цвет экрана
    screen_fg: default
    screen_bg: default
    # Заголовок
    header_fg: cyan
    header_bg: default
    # Подвал (строка статуса снизу)
    footer_fg: white
    footer_bg: default
    # Разделитель между списком и превью
    separator_fg: blue
    separator_bg: default
    # Список чатов (левая колонка)
    list_fg: default
    list_bg: default
    # Выделенная строка списка (курсор). Если оба default — используется reverse (как раньше).
    selected_fg: default
    selected_bg: default
  layout:
    # Минимальная ширина левого списка
    list_min_width: 30
    # Доля ширины экрана под левый список (0..1)
    list_width_ratio: 0.5
    # Минимальная ширина правого превью, иначе оно скрывается
    preview_min_width: 10
  text:
    header: "Выбор чатов: ↑/↓ PgUp/PgDn Home/End | Space=выбрать | Enter=OK | f=фильтр | /=поиск по имени | c=очистить | q/Esc=выход"
    no_chats: "Нет доступных чатов"
    search_prompt: "Поиск по имени: "
  keys:
    # Поддерживаются: enter, esc, space, up, down, pageup, pagedown, home, end, а также одиночные символы.
    quit: ["q", "esc"]
    confirm: ["enter"]
    toggle: ["space"]
    filter: ["f"]
    search: ["/"]
    clear: ["c"]
    up: ["up", "k"]
    down: ["down", "j"]
    page_up: ["pageup"]
    page_down: ["pagedown"]
    home: ["home"]
    end: ["end"]

# Список чатов для загрузки (поддерживается несколько чатов)
# Если не указано, будет предложен интерактивный выбор
chats:
  - chat_id: 123456789
    title: "Название чата"
    last_read_message_id: 0
    ids_to_retry: []
    enabled: true
  # - chat_id: 987654321
  #   title: "Другой чат"
  #   last_read_message_id: 0
  #   ids_to_retry: []
  #   enabled: true

# Старая структура (для обратной совместимости)
# Если указан chat_id, он будет использован как единственный чат
# chat_id: telegram_chat_id
# last_read_message_id: 0
# ids_to_retry: []
